---
phase: 16.1-user-priority-interaction
plan: 01
subsystem: ux
tags: [unity, monobehaviour, user-priority, timer, narrative-director, beat-assets]

# Dependency graph
requires:
  - phase: 16-integration-experience-loop
    provides: LivestreamController orchestrator, NarrativeDirector with ExecuteAyaChecksChat, beat assets with director notes
provides:
  - User silence timer in LivestreamController (configurable 120s threshold)
  - Gated bot message injection in NarrativeDirector.ExecuteAyaChecksChat
  - Drawing-focused director notes across all three beat assets
affects: []

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Func<bool> callback injection for cross-system state sharing (SetUserSilenceProvider, follows SetFactTracker pattern)"
    - "Three-way conditional in AyaChecksChat: user messages always, bots only after silence, else skip"

key-files:
  created: []
  modified:
    - Assets/AyaLiveStream/LivestreamController.cs
    - Assets/AyaLiveStream/NarrativeDirector.cs
    - Assets/AyaLiveStream/Data/Beat_WarmUp.asset
    - Assets/AyaLiveStream/Data/Beat_ArtProcess.asset
    - Assets/AyaLiveStream/Data/Beat_Characters.asset

key-decisions:
  - "Func<bool> callback injection into NarrativeDirector (not direct reference to LivestreamController)"
  - "_lastUserSpeechTime initialized to Time.time (not 0) -- gives user 2min to engage before bots get attention"
  - "_isUserSilent == null fallback preserves backward compatibility when no provider is set"
  - "Only AyaChecksChat bot injection is gated -- AyaDialogue scenes still fire normally for narrative progression"

patterns-established:
  - "User silence provider: Func<bool> callback injection via SetUserSilenceProvider() setter"
  - "Three-way message priority: user messages > silent-bots > skip"

# Metrics
duration: 2min
completed: 2026-02-18
---

# Phase 16.1 Plan 01: User-Priority Interaction Summary

**User silence timer (120s) gates bot message injection in AyaChecksChat, drawing-focused director notes shift Aya from talk-show host to artist-who-streams**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-18T05:25:58Z
- **Completed:** 2026-02-18T05:28:29Z
- **Tasks:** 2
- **Files modified:** 5

## Accomplishments
- LivestreamController tracks user silence via OnUserSpeakingStopped with configurable 120-second threshold, reset on every PTT use
- NarrativeDirector.ExecuteAyaChecksChat gates bot message injection behind a Func<bool> user silence callback -- user messages always pass, bots only after 2min silence, else skip with log
- All three beat director notes reframed from "drive conversation" to "focus on drawing, engage when prompted by viewers"

## Task Commits

Each task was committed atomically:

1. **Task 1: User silence timer and gated bot injection** - `eedba30` (feat)
2. **Task 2: Reframe beat director notes for drawing focus** - `feb7b98` (feat)

## Files Created/Modified
- `Assets/AyaLiveStream/LivestreamController.cs` - Added _userSilenceThreshold (120f), _lastUserSpeechTime, OnUserSpeakingStopped subscription, SetUserSilenceProvider injection
- `Assets/AyaLiveStream/NarrativeDirector.cs` - Added _isUserSilent field, SetUserSilenceProvider setter, three-way conditional in ExecuteAyaChecksChat
- `Assets/AyaLiveStream/Data/Beat_WarmUp.asset` - Director note: greet then settle into drawing, let viewer drive the chat
- `Assets/AyaLiveStream/Data/Beat_ArtProcess.asset` - Director note: deep creative flow, engage fully when viewer asks
- `Assets/AyaLiveStream/Data/Beat_Characters.asset` - Director note: share deeper story when prompted, build organically

## Decisions Made
- Followed plan as specified -- Func<bool> callback injection, Time.time initialization, null fallback for backward compatibility, only AyaChecksChat gated (not AyaDialogue)

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Phase 16.1 has only 1 plan -- phase is complete
- v1.0 Livestream Experience milestone is fully complete (Phases 12-16.1)
- Director note effectiveness depends on Gemini's interpretation of changed tone -- may need tuning in practice

---
*Phase: 16.1-user-priority-interaction*
*Completed: 2026-02-18*
