---
phase: 16.1-user-priority-interaction
verified: 2026-02-18T05:31:29Z
status: passed
score: 4/4 must-haves verified
---

# Phase 16.1: User-Priority Interaction Verification Report

**Phase Goal:** Shift the livestream interaction model to prioritize the user -- Aya greets viewers and focuses on drawing, only engages with chat bot messages if the user hasn't spoken via push-to-talk within 2 minutes. This gives the user more opportunity to ask questions and drive the conversation naturally, rather than Aya constantly responding to scripted bot chatter.
**Verified:** 2026-02-18T05:31:29Z
**Status:** passed
**Re-verification:** No -- initial verification

## Goal Achievement

### Observable Truths

| # | Truth | Status | Evidence |
|---|-------|--------|----------|
| 1 | Aya greets viewers on connection and then focuses on drawing activity rather than driving narrative | VERIFIED | Beat_WarmUp.asset directorNote contains "settle into your drawing -- your main focus is creating art" and "Let the viewer drive the chat" (line 21-27). Beat_ArtProcess.asset contains "focused on your art" and "stay focused on drawing" (line 21-26). Beat_Characters.asset contains "still focused on your drawing" (line 21-28). First scene WARMUP_GREET is AyaDialogue type (greet), followed by AyaChecksChat (respond to chat), then transition to art. |
| 2 | User PTT input is always prioritized -- Aya responds to user messages before any bot messages in AyaChecksChat | VERIFIED | NarrativeDirector.cs ExecuteAyaChecksChat (lines 429-447): three-way conditional checks `userMessages.Count > 0` FIRST (line 430), always routing user messages through before any bot message logic. This is unconditional -- user messages bypass the silence timer entirely. |
| 3 | Aya only responds to bot chat messages if the user has not spoken via PTT within 2 minutes | VERIFIED | NarrativeDirector.cs lines 435-447: the `else if` branch checks `_isUserSilent == null || _isUserSilent()` -- bots only pass when user has been silent for threshold. The `else` branch (line 441-447) returns early with a debug log when user is recently active. LivestreamController.cs line 39: `_userSilenceThreshold = 120f` (2 minutes). Line 102-103: silence provider lambda computes `Time.time - _lastUserSpeechTime >= _userSilenceThreshold`. |
| 4 | The 2-minute user silence timer resets each time the user speaks via PTT | VERIFIED | LivestreamController.cs line 95: `_onUserSpeakingStopped = () => { _lastUserSpeechTime = Time.time; };` resets timer to current time on every PTT release. Line 98: subscribed to `_session.OnUserSpeakingStopped`. PersonaSession.cs line 70 declares the event, line 323 invokes it. Line 94: `_lastUserSpeechTime = Time.time` initialization ensures the timer starts from experience start (not 0), giving user 2 minutes before bots get attention. |

**Score:** 4/4 truths verified

### Required Artifacts

| Artifact | Expected | Status | Details |
|----------|----------|--------|---------|
| `Assets/AyaLiveStream/LivestreamController.cs` | User silence timer with _lastUserSpeechTime, _userSilenceThreshold (120f), OnUserSpeakingStopped subscription, Func<bool> injection into NarrativeDirector | VERIFIED | 328 lines. _userSilenceThreshold declared line 39 (120f default). _lastUserSpeechTime line 51. _onUserSpeakingStopped handler line 59. Subscription line 98, unsubscription line 315-316. SetUserSilenceProvider injection lines 102-103. No stubs, no TODOs. |
| `Assets/AyaLiveStream/NarrativeDirector.cs` | SetUserSilenceProvider(Func<bool>) setter, gated bot message injection in ExecuteAyaChecksChat | VERIFIED | 553 lines. _isUserSilent field line 79. SetUserSilenceProvider setter lines 149-152. Three-way conditional in ExecuteAyaChecksChat lines 429-447 replacing the old single ternary. Backward-compatible null check (`_isUserSilent == null`) at line 435. No new stubs. |
| `Assets/AyaLiveStream/Data/Beat_WarmUp.asset` | Drawing-focused director note for warm-up beat | VERIFIED | 72 lines. directorNote contains "settle into your drawing" (line 23), "Let the viewer drive the chat" (line 27). Valid YAML with properly escaped single quotes. All other fields (beatId, timeBudgetSeconds, urgency, scenes, etc.) intact. |
| `Assets/AyaLiveStream/Data/Beat_ArtProcess.asset` | Drawing-focused director note for art process beat | VERIFIED | 83 lines. directorNote contains "focused on your art" (line 21), "stay focused on drawing" (line 25). Valid YAML. All non-directorNote fields preserved. |
| `Assets/AyaLiveStream/Data/Beat_Characters.asset` | User-responsive director note for characters beat | VERIFIED | 82 lines. directorNote contains "still focused on your drawing" (line 21), "engage with them" (line 28). Valid YAML. All non-directorNote fields preserved. |

### Key Link Verification

| From | To | Via | Status | Details |
|------|----|-----|--------|---------|
| LivestreamController.cs | NarrativeDirector.cs | SetUserSilenceProvider(Func<bool>) call in Start() | WIRED | LivestreamController line 102-103 calls `_narrativeDirector?.SetUserSilenceProvider(...)` with lambda. NarrativeDirector line 149-152 receives and stores as `_isUserSilent`. Lambda computes `Time.time - _lastUserSpeechTime >= _userSilenceThreshold`. |
| LivestreamController.cs | PersonaSession.OnUserSpeakingStopped | Event subscription for timer reset | WIRED | Subscribe: line 98 `_session.OnUserSpeakingStopped += _onUserSpeakingStopped`. Unsubscribe: lines 315-316 in OnDestroy. PersonaSession.cs declares event at line 70, invokes at line 323. Handler (line 95) resets `_lastUserSpeechTime = Time.time`. |
| NarrativeDirector.cs | _isUserSilent callback | Gate in ExecuteAyaChecksChat that skips bot messages when user is active | WIRED | Line 435: `_isUserSilent == null || _isUserSilent()` -- gates bot message processing. When false (user recently active), lines 441-447 return early with debug log. User messages (line 430-433) always bypass gate. |

### Requirements Coverage

No formal requirements mapped to Phase 16.1 (UX refinement of existing experience per ROADMAP.md).

### Anti-Patterns Found

| File | Line | Pattern | Severity | Impact |
|------|------|---------|----------|--------|
| NarrativeDirector.cs | 369 | "UserChoice not implemented in Phase 14 per scope" | Info | Pre-existing from Phase 14, not introduced by Phase 16.1. Not a blocker -- UserChoice scenes are not part of the current narrative. |
| NarrativeDirector.cs | 474 | "Phase 15 placeholder for action execution" | Info | Pre-existing from Phase 15. AyaAction logs only. Not a blocker -- no AyaAction scenes in current beat configs. |

No blocker or warning anti-patterns introduced by Phase 16.1.

### Unintended Modifications Check

| File | Expected State | Actual State |
|------|---------------|--------------|
| PushToTalkController.cs | NOT modified | Clean (no diff) |
| ChatBotManager.cs | NOT modified | Clean (no diff) |

### Human Verification Required

### 1. Director Note Effectiveness
**Test:** Run the livestream experience and observe Aya's behavior during the warm-up beat. Does she greet, then settle into drawing-focused commentary rather than driving conversation?
**Expected:** Aya greets viewers, mentions what she's working on, then focuses on art commentary. She should NOT launch into scripted monologues about characters or story unprompted.
**Why human:** Director notes are natural language instructions interpreted by Gemini -- correct implementation does not guarantee correct LLM interpretation.

### 2. User Priority Feel
**Test:** Start the experience, wait 30 seconds, then speak via PTT. Observe if Aya responds to you rather than to any bot messages.
**Expected:** Aya addresses your question/comment directly, ignoring any pending bot messages. After you stop speaking, the 2-minute timer should restart.
**Why human:** The timer logic is structurally verified, but the actual user experience depends on Gemini's response latency, PTT timing, and scene execution ordering.

### 3. Bot Message Resumption After Silence
**Test:** Start the experience and do NOT speak via PTT for at least 2 minutes. Observe if Aya begins responding to bot chat messages after the silence window expires.
**Expected:** After ~2 minutes of no PTT input, AyaChecksChat scenes should start processing bot messages normally.
**Why human:** Requires real-time observation of the timer threshold behavior in the running application.

### Gaps Summary

No gaps found. All four observable truths are verified at all three levels (existence, substantive, wired). The implementation matches the plan exactly:

1. **LivestreamController** tracks user silence with a configurable 120-second threshold, initializing `_lastUserSpeechTime` to `Time.time` (not 0), resetting on every `OnUserSpeakingStopped` event, and injecting the silence check into NarrativeDirector via `SetUserSilenceProvider`.

2. **NarrativeDirector** gates bot message injection in `ExecuteAyaChecksChat` with a three-way conditional: user messages always pass, bot messages only pass when the user has been silent for 2+ minutes (or no provider is set for backward compatibility), otherwise early return with a debug log.

3. **Beat director notes** are reframed from "drive conversation" to "focus on drawing, engage when prompted by viewers" across all three beat assets, with proper YAML escaping and no changes to non-directorNote fields.

4. **No unintended modifications** to PushToTalkController or ChatBotManager.

---

_Verified: 2026-02-18T05:31:29Z_
_Verifier: Claude (gsd-verifier)_
