---
phase: 13-chat-bot-system
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs
autonomous: true

must_haves:
  truths:
    - "Nevatars chatBurstMessages are extracted from all 100 pattern .asset files"
    - "Messages are distributed across 6 AI-Embodiment bots by personality fit (not dumped into every bot)"
    - "Each bot's messageAlternatives array is populated with personality-appropriate lines"
    - "Migration runs via Unity Editor menu item and updates the existing ChatBotConfig .asset files"
    - "Bot message pools are large enough for a 10-15 minute session without immediate repeats"
  artifacts:
    - path: "Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs"
      provides: "Editor script extracting nevatars chatBurstMessages and distributing to ChatBotConfig assets"
      min_lines: 80
  key_links:
    - from: "Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs"
      to: "nevatars Patterns/ directory"
      via: "YAML parsing of .asset files to extract chatBurstMessages strings"
      pattern: "chatBurstMessages"
    - from: "Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs"
      to: "Assets/AyaLiveStream/ChatBotConfigs/*.asset"
      via: "SerializedObject.FindProperty to write messageAlternatives"
      pattern: "messageAlternatives"
---

<objective>
Create an editor migration script that extracts chatBurstMessages from the nevatars ResponsePattern assets and distributes them across the 6 AI-Embodiment ChatBotConfig assets as messageAlternatives, curated by personality fit.

Purpose: The scripted burst loop (Plan 01) picks from combined scriptedMessages + messageAlternatives pools. Currently messageAlternatives is empty on all 6 bots. This migration populates those pools with 300+ messages from nevatars, distributed by personality, giving each bot a deep enough message pool for 10-15 minute sessions without immediate repeats.

Output: MigrateResponsePatterns.cs editor script that runs via menu item and populates all 6 ChatBotConfig .asset files.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-chat-bot-system/13-RESEARCH.md

@Assets/AyaLiveStream/ChatBotConfig.cs
@Assets/AyaLiveStream/ChatBotConfigs/Dad_JohnConfig.asset
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MigrateResponsePatterns editor script with personality-curated distribution</name>
  <files>Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs</files>
  <action>
Create MigrateResponsePatterns.cs in the Assets/AyaLiveStream/Editor/ directory. This is an editor-only script (the Editor asmdef already exists from Plan 12-02).

**Class structure:**
- Static class `MigrateResponsePatterns` in `AIEmbodiment.Samples.Editor` namespace (or just use the existing editor namespace convention from MigrateChatBotConfigs.cs -- check that file's namespace and match it)
- Menu item: `[MenuItem("AI Embodiment/Samples/Migrate Response Patterns")]`

**Step 1: Extract all chatBurstMessages from nevatars**
The nevatars pattern .asset files are at the ABSOLUTE path:
`/home/cachy/workspaces/projects/games/nevatars/Assets/_Project/DialogueAI/StreamingBotsDemo/Data/Patterns/`

Read all Pattern_*.asset files (skip Fallback_* files -- they have no chatBurstMessages). Parse the YAML manually using simple string operations (these are Unity YAML files, not complex nested structures):
- Read each file as text
- Find lines that start with `  - ` after the `chatBurstMessages:` line
- Collect each message string
- Deduplicate across all patterns (some messages may appear in multiple patterns)
- Log total unique messages found

Expected: approximately 300-400 unique message strings from 100 pattern files (each has 2-4 chatBurstMessages).

**Step 2: Categorize messages by personality fit**
Create a hardcoded categorization system. Define keyword/tone sets for each of the 6 bots:

**TeenFan_Miko** (enthusiastic, short, caps, emojis):
- Messages containing excitement indicators: "!!", "omg", "so cool", "love", "amazing", "yes", "lets go", "can't wait", "exciting", "wow"
- Short messages (under 6 words)
- Transform: Add "!!" if missing, occasionally CAPS

**Dad_John** (supportive, encouraging, no emojis):
- Messages containing supportive/encouraging tone: "great", "proud", "keep", "wonderful", "nice", "good", "awesome", "that's my", "well done", "support"
- Messages about family, care, health

**ArtStudent_Priya** (thoughtful, technical):
- Messages about art, technique, style, color, design, composition, skill, creative, process, reference, anatomy, perspective
- Longer, more thoughtful messages

**Regular_TechBro42** (referencing, knowledgeable):
- Messages about experience, been here, day one, fan, community, content, stream, remember when
- Messages showing familiarity/regular viewer status

**Troll_xXShadowXx** (contrarian, provocative):
- Messages containing contrarian tone: "is it though", "actually", "seen better", "overrated", "meh", "mid", "not really", "sure about that"
- Short, deflating messages
- Transform: remove exclamation marks, make lowercase

**Lurker_Ghost404** (minimal, lowercase):
- Very short messages only (1-3 words): "cool", "nice", "wow", "lol", "same", "mood", "real", "true"
- Transform: all lowercase, strip punctuation except periods

**Categorization algorithm:**
For each extracted message:
1. Check against each bot's keyword set (case-insensitive)
2. If a message matches multiple bots, assign to the BEST match (most keyword hits)
3. If a message matches NO bot specifically, assign to a "general" pool
4. Distribute the general pool roughly evenly across TeenFan_Miko, Dad_John, ArtStudent_Priya, and Regular_TechBro42 (skip Troll and Lurker for generic messages)

After categorization, apply per-bot transforms:
- TeenFan_Miko: ensure enthusiasm (add "!!" if no exclamation, occasionally random caps word)
- Troll_xXShadowXx: ensure contrarian tone (strip exclamations, lowercase)
- Lurker_Ghost404: truncate to max 4 words, all lowercase, strip trailing punctuation
- Dad_John, ArtStudent_Priya, Regular_TechBro42: keep as-is (they already fit naturally)

**Step 3: Write to ChatBotConfig assets**
Load all 6 ChatBotConfig assets from `Assets/AyaLiveStream/ChatBotConfigs/`:
- Dad_JohnConfig.asset
- TeenFan_MikoConfig.asset
- ArtStudent_PriyaConfig.asset
- Regular_TechBro42Config.asset
- Troll_xXShadowXxConfig.asset
- Lurker_Ghost404Config.asset

Use `AssetDatabase.FindAssets("t:ChatBotConfig", new[] { "Assets/AyaLiveStream/ChatBotConfigs" })` to load them.

For each bot:
1. Get the categorized messages for that bot
2. Use `SerializedObject` and `FindProperty("messageAlternatives")` to set the array
3. Set array size, then set each element's stringValue
4. `serializedObject.ApplyModifiedProperties()`
5. `EditorUtility.SetDirty(config)`

After all bots updated:
- `AssetDatabase.SaveAssets()`
- Log summary: how many messages assigned to each bot

**Important considerations:**
- Use absolute path to nevatars project since it is a sibling project, not inside AI-Embodiment
- Check if nevatars directory exists at runtime and log clear error if not found
- The 10 Fallback_* patterns have triggerChatBurst: 0 and empty chatBurstMessages -- skip them
- Some chatBurstMessages may have leading/trailing whitespace in YAML -- trim all extracted strings
- Deduplicate within each bot's final list (a message should not appear twice for the same bot)
  </action>
  <verify>
1. File exists at Assets/AyaLiveStream/Editor/MigrateResponsePatterns.cs
2. Menu item path is "AI Embodiment/Samples/Migrate Response Patterns"
3. Script reads from the absolute nevatars Patterns/ path
4. Personality categorization covers all 6 bots with distinct keyword sets
5. Per-bot transforms are applied (caps for Miko, lowercase for Ghost404, etc.)
6. Messages are written to messageAlternatives via SerializedObject API
7. AssetDatabase.SaveAssets() is called at the end
8. Summary log shows per-bot message counts
  </verify>
  <done>
MigrateResponsePatterns.cs editor script exists that:
- Extracts all unique chatBurstMessages from 100 nevatars ResponsePattern .asset files
- Categorizes messages across 6 bots by personality-fit keywords
- Applies per-bot style transforms (caps, lowercase, truncation)
- Distributes uncategorized messages evenly across 4 main bots
- Writes results to each ChatBotConfig's messageAlternatives array
- Runs via Unity Editor menu: AI Embodiment > Samples > Migrate Response Patterns
  </done>
</task>

<task type="auto">
  <name>Task 2: Validate migration by inspecting one bot config asset</name>
  <files>Assets/AyaLiveStream/ChatBotConfigs/Dad_JohnConfig.asset</files>
  <action>
After writing the migration script, we cannot run it (no Unity Editor in CLI). Instead, validate the script by:

1. Re-read MigrateResponsePatterns.cs to verify it compiles structurally
2. Spot-check: read 3 nevatars pattern .asset files to confirm the YAML parsing logic would correctly extract their chatBurstMessages
3. Verify the YAML parsing handles both single-line (`  - message text`) and potential multi-line formats
4. Verify AssetDatabase and SerializedObject usage matches the pattern in the existing MigrateChatBotConfigs.cs

This is a code review task, not an execution task. The migration will be run by the user in Unity Editor.

Log any issues found and fix them in MigrateResponsePatterns.cs.
  </action>
  <verify>
1. MigrateResponsePatterns.cs YAML parsing logic correctly handles the `  - message text` format seen in nevatars .asset files
2. SerializedObject/FindProperty usage matches the existing MigrateChatBotConfigs.cs pattern
3. No obvious compilation errors (balanced braces, correct using statements, proper Unity Editor API usage)
  </verify>
  <done>Migration script is structurally verified and ready to run in Unity Editor. YAML parsing correctly targets the chatBurstMessages format. SerializedObject API usage follows the established project pattern.</done>
</task>

</tasks>

<verification>
1. MigrateResponsePatterns.cs exists in Assets/AyaLiveStream/Editor/
2. Script extracts from nevatars absolute path (not a relative path that would break)
3. Personality categorization produces distinct message pools per bot (not identical pools)
4. Per-bot transforms ensure style consistency (Miko enthusiastic, Ghost404 minimal, etc.)
5. Script uses the same editor API patterns as existing MigrateChatBotConfigs.cs
6. Menu item is registered under "AI Embodiment/Samples/" path
</verification>

<success_criteria>
- MigrateResponsePatterns.cs editor script exists and is ready to run
- When run in Unity Editor, it extracts chatBurstMessages from nevatars, distributes them by personality, and populates messageAlternatives on all 6 ChatBotConfig assets
- Each bot ends up with a personality-appropriate subset of messages (not the same messages on every bot)
- Dad_JohnConfig gets supportive messages, TeenFan_MikoConfig gets enthusiastic messages, etc.
- Total pool per bot is large enough (15-50+ messages) for a session without immediate repeats
</success_criteria>

<output>
After completion, create `.planning/phases/13-chat-bot-system/13-03-SUMMARY.md`
</output>
